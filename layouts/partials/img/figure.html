{{ if .a.link }}<a class="link-block" href="{{ .a.link | safeHTMLAttr }}"
                   {{ with .a.target }}target="{{ . | safeHTMLAttr }}"{{ end }}
        {{ with $.a.rel }}rel="{{ . | safeHTMLAttr }}"{{ end }}>
    {{ end }}
    {{ $class := slice }}
    {{ with .a.class }}
        {{ if not (reflect.IsMap .) }}
            {{ $class = $class | append . }}
        {{ else }}
            {{ range $k, $v := . }}
                {{ $class = $class | append $v }}
            {{ end }}
        {{ end }}
    {{ end }}
    {{ $class = delimit $class " " }}
  <figure class="{{ $class | safeHTMLAttr }}">
      {{ partial "img/img.html" (dict "img" .img "a" .a) }}
      {{ $unsplash := ( partial "img/func/get-unsplash.html" .img ) }}
      {{ if (or .a.caption .a.attr $unsplash)}}
        <figcaption class="caption">
            {{- with .a.caption }}<span class="caption__text">{{ . | site.Home.RenderString }}</span>{{ end -}}
            {{- with .a.attr -}}
                {{ $attribution := ( . | site.Home.RenderString ) }}
                {{ with $.a.attrlink }}
                  <a class="caption__attribution" href="{{ . | safeHTMLAttr }}">{{ $attribution }}</a>
                {{ else }}
                  <span class="caption__attribution">{{ $attribution }}</span>
                {{ end }}
            {{ else }}
                {{ with $unsplash }}
                  <span class="caption__attribution">Â <a
                            href="{{ .link | safeHTMLAttr }}">{{ .name }}&hairsp;/&hairsp;Unsplash</a></span>
                {{ end }}
            {{ end }}
        </figcaption>
      {{ end }}
  </figure>
    {{ if .a.link }}
</a>
{{ end }}
